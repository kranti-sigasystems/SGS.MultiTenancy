@model SGS.MultiTenancy.Core.Application.DTOs.Auth.UserDto

@{
    ViewData["Title"] = "User Profile";
    var primaryAddress = Model.Addresses?.FirstOrDefault(a => a.IsDefault)
                         ?? Model.Addresses?.FirstOrDefault();
}

<style>
    .profile-container {
        max-width: 1080px;
    }

    .card-ui {
        background: #ffffff;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        padding: 1.75rem;
    }

    .sidebar-card {
        position: sticky;
        top: 90px;
    }

    .avatar-wrapper {
        width: 88px;
        height: 88px;
        border-radius: 8px;
        overflow: hidden;
        background: #f8f9fa;
        flex-shrink: 0;
    }

        .avatar-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

    .section-title {
        font-size: 0.85rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.6px;
        color: #6c757d;
        margin-bottom: 1.5rem;
    }

    .label-sm {
        font-size: 0.75rem;
        text-transform: uppercase;
        font-weight: 600;
        color: #6c757d;
    }

    .value-md {
        font-weight: 500;
        margin-bottom: 1.25rem;
    }

    .address-card {
        border: 1px solid #eef1f4;
        border-radius: 6px;
        padding: 1rem;
        background: #fbfbfc;
        height: 100%;
    }

    .status-badge {
        font-size: 0.7rem;
        font-weight: 600;
        padding: 0.4rem 0.75rem;
        border-radius: 50px;
    }

    .status-active {
        background: #e6f4ea;
        color: #198754;
    }

    .status-inactive {
        background: #fdecea;
        color: #dc3545;
    }
</style>

<main class="container profile-container py-5">

    <!-- Top Header -->
    <div class="d-flex justify-content-between align-items-center mb-5">
        <div>
            <h4 class="fw-semibold mb-1">@Model.UserName</h4>
            <small hidden class="text-muted">User ID: @Model.ID</small>
        </div>

        <div class="d-flex gap-2">
            <a asp-action="Index" asp-controller="User" class="btn btn-outline-secondary">
                Back
            </a>
            <a asp-action="Edit" asp-route-id="@Model.ID" class="btn btn-primary">
                Edit
            </a>
        </div>
    </div>

    <div class="row g-4">

        <!-- Sidebar -->
        <aside class="col-lg-4 col-xl-3">
            <div class="card-ui sidebar-card " style="height: 388px;">

                <div class="d-flex align-items-center gap-3 mb-4">
                    <div class="avatar-wrapper">
                        @if (!string.IsNullOrWhiteSpace(Model.AvtarUrl))
                        {
                            <img src="/@Model.AvtarUrl" alt="Profile Image" />
                        }
                        else
                        {
                            <div class="d-flex align-items-center justify-content-center h-100 text-muted">
                                <i class="bi bi-person fs-3"></i>
                            </div>
                        }
                    </div>
                </div>

                <div class="mb-3">
                    <span class="status-badge @(Model.Status == SGS.MultiTenancy.Core.Domain.Enums.EntityStatus.Active ? "status-active" : "status-inactive")">
                        @(Model.Status == SGS.MultiTenancy.Core.Domain.Enums.EntityStatus.Active ? "Active" : "Inactive")
                    </span>
                </div>

                <hr />

                <div class="value-md" hidden>@Model.TenantId</div>

                <div class="label-sm">Primary Phone</div>
                <div class="value-md">
                    @(string.IsNullOrWhiteSpace(primaryAddress?.PhoneNumber)
                                        ? "Not provided"
                                        : primaryAddress.PhoneNumber)
                </div>

            </div>
        </aside>

        <!-- Main Content -->
        <section class="col-lg-8 col-xl-9">

            <!-- Basic Information -->
            <div class="card-ui mb-4">
                <div class="section-title">Basic Information</div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="label-sm">User Name</div>
                        <div class="value-md">@Model.UserName.ToUpper()</div>
                    </div>

                    <div class="col-md-6">
                        <div class="label-sm">Email Address</div>
                        <div class="value-md">
                            <a href="mailto:@Model.Email">@Model.Email</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Address Section -->
            <div class="card-ui">
                <div class="section-title">User Addresses</div>

                @if (Model.Addresses == null || !Model.Addresses.Any())
                {
                    <div class="text-muted">No address information available.</div>
                }
                else
                {
                    <div class="row g-5">
                        @foreach (var address in Model.Addresses)
                        {
                            <div class="col-md-6">
                                <div class="address-card">

                                    @if (address.IsDefault)
                                    {
                                        <span class="badge bg-primary mb-2">Primary</span>
                                    }

                                    <div class="fw-semibold mb-1">
                                        @address.AddressLine
                                    </div>

                                    <div class="small text-muted">
                                        @address.City, @address.State
                                    </div>

                                    <div class="small text-muted">
                                        @address.PostalCode • @address.Country
                                    </div>

                                </div>
                            </div>
                        }
                    </div>
                }
            </div>

        </section>
    </div>
</main>

